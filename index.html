<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Tmall1111 : 天猫11.11活动，红包查看器">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <script src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>

    <title>Tmall1111</title>
    
    <style>
		.fcous{
			
			color: #FF0000;
		}	
		
	</style>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/OstrichAlgorithm/tmall1111">View on GitHub</a>

          <h1 id="project_title">Tmall1111</h1>
          <h2 id="project_tagline">天猫11.11活动，红包查看器</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/OstrichAlgorithm/tmall1111/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/OstrichAlgorithm/tmall1111/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
		

      		<div id="view">
			<button value="开始" onclick="start()">开始</button>
		    <button value="停止" onclick="stop()" >停止</button>	
		    <button id="timer">当前时间:</button>  
		    <button id="winner">上次1111时间: </button>  
		</div>  
	<h3>观察了一会，感觉100+的红包会连续出现</h3>
		<h3>设定了，当出现100+红包时候，会弹窗提示，这时候拿100+的红包的概率可能大一下吧,是#概率#不是一定</h3>
		<h3>好吧，我承认- -||的确是很无聊的东西</h3>
	    <table id="table"></table>
	     <!-- <table id="winner">1000</table>-->
	<script type="text/javascript">
        var more = 0;
        function start() {
            postAward();
            int = self.setInterval("postAward()", 2000);
            showTime();
            int2 = self.setInterval("showTime()", 1000);
        }
        function stop() {
            clearInterval(int);
            clearInterval(int2);
        }


		
	
         function postAward() {
            $.ajax({
                url: "https://hi.alipay.com/query/winner_c.json?campFlag=AWX%2BGunqCChuxuWgasjM58Hb5hPq4kFm&_callback=getData",
                type: 'GET',
                async: true,
                dataType: 'jsonp',
                jsonpCallback: 'getData',
                success: function(data){  
                    console.log("success");
                },  
                error: function(e){  
                    console.log("error");
                } 
            });
        }


        function getData(data) {
            var s = '';
            more=0;
            $(data.winners) .each(function (i, item) {
                s += '<tr>';    
                var num = parseInt(getNum(item.prizeName),10);
              if( num>99){
              	 s += '<td class="fcous">';
              	
              	 more++;
              	  if (num>1000) {
              	 	 $("#winner").html('上次1111时间:'+getTime());
              	 }
              }else{
              	 s += '<td>';   
              }
                s += item.prizeName;
                s += '</td>';
                s += '<td>';
                s += item.userName;
                s += '</td>';
//              s += '<td>';
//              s += getTime();
//              s += '</td>';
                s += '</tr>'; 
                
                
                
            });
            $("#table").html(s);
           // $('html, body').animate({scrollTop: $(document).height()},3000); 
        }

		function getTime(){
			var d = new Date();
			var str = '';
			 str += d.getFullYear()+'.';
			 str  += d.getMonth() + 1+'.';
			 str  += d.getDate()+' ';
			 str += d.getHours()+':'; 
			 str  += d.getMinutes()+':'; 
			str+= d.getSeconds(); 
			return str;
		}
		
		function getNum(str){
			var reg = /[\u4e00-\u9fa5]+/g;
			var ret = str.replace( reg , escape("") ) ;
			return ret;
		}

         function showTime(){
            $("#timer").html("当前时间: "+getTime());
         }
         function tip(){
              if(more >= 1){
                  alert("有100以上的红包出现");
                  setTimeout("tip()", 20000);
              } else{        
                  setTimeout("tip()", 1000);
              }
        }
        setTimeout(tip, 1000);

    </script>


 </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Tmall1111 maintained by <a href="https://github.com/OstrichAlgorithm">OstrichAlgorithm</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
